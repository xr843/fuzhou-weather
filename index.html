<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦å·ä¸ƒå¤©å¤©æ°”é¢„æŠ¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
            color: #2c3e50;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .header p {
            font-size: 1.2rem;
            color: #576574;
        }
        
        .weather-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
            max-width: 1200px;
            width: 100%;
        }
        
        .weather-card {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            width: 220px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }
        
        .weather-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        .card-header {
            color: white;
            padding: 1.5rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            height: 160px;
        }
        
        .sunny {
            background: linear-gradient(to bottom, #FF7E00, #FFB75E);
        }
        
        .cloudy {
            background: linear-gradient(to bottom, #757F9A, #D7DDE8);
        }
        
        .rainy {
            background: linear-gradient(to bottom, #4B79A1, #283E51);
        }
        
        .thunderstorm {
            background: linear-gradient(to bottom, #373B44, #4286f4);
        }
        
        .foggy, .mist, .haze {
            background: linear-gradient(to bottom, #606c88, #3f4c6b);
        }
        
        .snowy {
            background: linear-gradient(to bottom, #8E9EAB, #FFFFFF);
        }
        
        .overcast {
            background: linear-gradient(to bottom, #5D4157, #A8CABA);
        }
        
        .date {
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .day {
            font-size: 0.9rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }
        
        .weather-desc {
            font-size: 1rem;
            background-color: rgba(0,0,0,0.2);
            border-radius: 50px;
            padding: 5px 10px;
            display: inline-block;
            margin-bottom: 0.5rem;
        }
        
        .card-body {
            padding: 1.5rem;
            text-align: center;
        }
        
        .temperature {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 1rem;
        }
        
        .details {
            display: flex;
            justify-content: space-between;
            color: #576574;
            font-size: 0.9rem;
        }
        
        .details div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .details span {
            margin-top: 0.3rem;
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        
        /* é˜³å…‰åŠ¨ç”» */
        .sun {
            position: absolute;
            top: 25px;
            right: 25px;
            width: 40px;
            height: 40px;
            background: #FFD400;
            border-radius: 50%;
            box-shadow: 0 0 40px #FF7E00;
            animation: pulse 3s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 20px #FF7E00;
            }
            50% {
                box-shadow: 0 0 40px #FF7E00;
            }
            100% {
                box-shadow: 0 0 20px #FF7E00;
            }
        }
        
        /* äº‘æœµåŠ¨ç”» */
        .cloud {
            position: absolute;
            top: 30px;
            right: 25px;
            width: 60px;
            height: 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            animation: float 5s infinite ease-in-out;
        }
        
        .cloud:before {
            content: '';
            position: absolute;
            top: -15px;
            left: 12px;
            width: 25px;
            height: 25px;
            background: white;
            border-radius: 50%;
        }
        
        .cloud:after {
            content: '';
            position: absolute;
            top: -22px;
            right: 12px;
            width: 25px;
            height: 25px;
            background: white;
            border-radius: 50%;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(-15px);
            }
        }
        
        /* é›¨æ»´åŠ¨ç”» */
        .rain {
            position: absolute;
            top: 50px;
            left: 0;
            width: 100%;
            height: 100px;
        }
        
        .drop {
            position: absolute;
            width: 2px;
            height: 10px;
            background: #CCE6FF;
            border-radius: 0 0 5px 5px;
            animation: rain-drop 1s infinite linear;
        }
        
        .drop:nth-child(1) {
            left: 30%;
            animation-delay: 0.1s;
        }
        
        .drop:nth-child(2) {
            left: 50%;
            animation-delay: 0.3s;
        }
        
        .drop:nth-child(3) {
            left: 70%;
            animation-delay: 0.5s;
        }
        
        .drop:nth-child(4) {
            left: 40%;
            animation-delay: 0.7s;
        }
        
        .drop:nth-child(5) {
            left: 60%;
            animation-delay: 0.9s;
        }
        
        @keyframes rain-drop {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(70px);
                opacity: 0;
            }
        }
        
        /* é›·ç”µåŠ¨ç”» */
        .lightning {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .bolt {
            position: absolute;
            width: 30px;
            height: 45px;
            background: #FFD700;
            clip-path: polygon(50% 0, 0% 100%, 45% 60%, 50% 100%, 100% 15%, 55% 40%, 50% 0);
            animation: flash 3s infinite;
            opacity: 0;
        }
        
        @keyframes flash {
            0%, 90%, 100% {
                opacity: 0;
            }
            92%, 94%, 96% {
                opacity: 1;
            }
        }
        
        /* é›¾æ°”åŠ¨ç”» */
        .fog {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        
        .fog-wave {
            position: absolute;
            width: 200%;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: fog-move 10s infinite linear;
        }
        
        .fog-wave:nth-child(1) {
            top: 20%;
            left: -50%;
            animation-delay: 0s;
        }
        
        .fog-wave:nth-child(2) {
            top: 40%;
            left: -30%;
            animation-delay: 2s;
        }
        
        .fog-wave:nth-child(3) {
            top: 60%;
            left: -70%;
            animation-delay: 4s;
        }
        
        @keyframes fog-move {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(100%);
            }
        }
        
        /* é›ªèŠ±åŠ¨ç”» */
        .snow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .snowflake {
            position: absolute;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: snowfall 5s infinite linear;
        }
        
        .snowflake:nth-child(1) {
            left: 20%;
            animation-delay: 0s;
        }
        
        .snowflake:nth-child(2) {
            left: 40%;
            animation-delay: 1s;
        }
        
        .snowflake:nth-child(3) {
            left: 60%;
            animation-delay: 2s;
        }
        
        .snowflake:nth-child(4) {
            left: 80%;
            animation-delay: 3s;
        }
        
        .snowflake:nth-child(5) {
            left: 30%;
            animation-delay: 4s;
        }
        
        @keyframes snowfall {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* é˜´å¤©åŠ¨ç”» */
        .overcast-clouds {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .overcast-cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
        }
        
        .overcast-cloud:nth-child(1) {
            width: 80px;
            height: 30px;
            top: 20px;
            left: 20px;
            animation: drift 15s infinite ease-in-out;
        }
        
        .overcast-cloud:nth-child(2) {
            width: 60px;
            height: 25px;
            top: 40px;
            right: 20px;
            animation: drift 12s infinite ease-in-out reverse;
        }
        
        .overcast-cloud:nth-child(3) {
            width: 70px;
            height: 20px;
            bottom: 30px;
            left: 50px;
            animation: drift 18s infinite ease-in-out;
        }
        
        @keyframes drift {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(20px);
            }
        }
        
        .loading {
            margin: 3rem auto;
            text-align: center;
            color: #2c3e50;
        }
        
        .loading p {
            margin-top: 1rem;
        }
        
        .footer {
            margin-top: 3rem;
            text-align: center;
            color: #576574;
            font-size: 0.9rem;
        }
        
        .error-message {
            background-color: #ffeaea;
            border-left: 4px solid #ff5252;
            padding: 1rem;
            margin: 2rem auto;
            max-width: 600px;
            color: #d32f2f;
            border-radius: 4px;
        }
        
        .api-status {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .refresh-button {
            background-color: #4A90E2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.2s;
        }
        
        .refresh-button:hover {
            background-color: #357ABD;
        }
        
        @media (max-width: 768px) {
            .weather-container {
                flex-direction: column;
                align-items: center;
            }
            
            .weather-card {
                width: 280px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ç¦å·ä¸ƒå¤©å¤©æ°”é¢„æŠ¥</h1>
        <p>å½“å‰æ—¥æœŸ: <span id="current-date"></span></p>
        <div class="api-status">æœ€åæ›´æ–°: <span id="last-updated">åŠ è½½ä¸­...</span></div>
        <button class="refresh-button" onclick="fetchWeatherData()">åˆ·æ–°å¤©æ°”æ•°æ®</button>
    </div>
    
    <div id="error-container"></div>
    
    <div id="loading" class="loading">
        <svg width="50" height="50" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <style>
                .spinner {
                    animation: rotate 2s linear infinite;
                    transform-origin: center;
                }
                .path {
                    stroke: #4A90E2;
                    stroke-width: 2;
                    stroke-dasharray: 80, 200;
                    stroke-dashoffset: 0;
                    animation: dash 1.5s ease-in-out infinite;
                }
                @keyframes rotate {
                    100% {
                        transform: rotate(360deg);
                    }
                }
                @keyframes dash {
                    0% {
                        stroke-dasharray: 1, 200;
                        stroke-dashoffset: 0;
                    }
                    50% {
                        stroke-dasharray: 89, 200;
                        stroke-dashoffset: -35px;
                    }
                    100% {
                        stroke-dasharray: 89, 200;
                        stroke-dashoffset: -124px;
                    }
                }
            </style>
            <circle class="spinner path" cx="12" cy="12" r="10" fill="none"/>
        </svg>
        <p>åŠ è½½å¤©æ°”æ•°æ®ä¸­...</p>
    </div>
    
    <div id="weather-container" class="weather-container" style="display: none;"></div>
    
    <div class="footer">
        <p>Â© 2025 ç¦å·å¤©æ°”é¢„æŠ¥ | æ•°æ®ç”±OpenWeatherMapæä¾›</p>
    </div>
    
    <script>
        // æ˜¾ç¤ºå½“å‰æ—¥æœŸ
        const currentDate = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
        document.getElementById('current-date').textContent = currentDate.toLocaleDateString('zh-CN', options);
        
        // APIå¯†é’¥ - æ³¨æ„ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥ä¿æŠ¤æ‚¨çš„APIå¯†é’¥
        const API_KEY = '6601bce5eda236a14644cb89c4ae43b6';
        
        // ç¦å·çš„åæ ‡
        const LATITUDE = 26.0745;
        const LONGITUDE = 119.2965;
        
        // å®šä¹‰æ˜ŸæœŸå‡ çš„ä¸­æ–‡åç§°
        const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
        
        // å¤©æ°”ç±»å‹æ˜ å°„åˆ°CSSç±»å’ŒåŠ¨ç”»å…ƒç´ 
        const weatherTypeMap = {
            'Clear': {
                class: 'sunny',
                elements: '<div class="sun"></div>'
            },
            'Clouds': {
                class: 'cloudy',
                elements: '<div class="cloud"></div>'
            },
            'Rain': {
                class: 'rainy',
                elements: '<div class="rain"><div class="drop"></div><div class="drop"></div><div class="drop"></div><div class="drop"></div><div class="drop"></div></div>'
            },
            'Drizzle': {
                class: 'rainy',
                elements: '<div class="rain"><div class="drop"></div><div class="drop"></div><div class="drop"></div><div class="drop"></div><div class="drop"></div></div>'
            },
            'Thunderstorm': {
                class: 'thunderstorm',
                elements: '<div class="rain"><div class="drop"></div><div class="drop"></div><div class="drop"></div><div class="drop"></div><div class="drop"></div></div><div class="lightning"><div class="bolt"></div></div>'
            },
            'Snow': {
                class: 'snowy',
                elements: '<div class="snow"><div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div></div>'
            },
            'Mist': {
                class: 'foggy',
                elements: '<div class="fog"><div class="fog-wave"></div><div class="fog-wave"></div><div class="fog-wave"></div></div>'
            },
            'Fog': {
                class: 'foggy',
                elements: '<div class="fog"><div class="fog-wave"></div><div class="fog-wave"></div><div class="fog-wave"></div></div>'
            },
            'Haze': {
                class: 'foggy',
                elements: '<div class="fog"><div class="fog-wave"></div><div class="fog-wave"></div><div class="fog-wave"></div></div>'
            },
            'default': {
                class: 'cloudy',
                elements: '<div class="cloud"></div>'
            }
        };
        
        // è·å–å¤©æ°”æ•°æ®
        async function fetchWeatherData() {
            const loadingElement = document.getElementById('loading');
            const weatherContainer = document.getElementById('weather-container');
            const errorContainer = document.getElementById('error-container');
            
            loadingElement.style.display = 'block';
            weatherContainer.style.display = 'none';
            errorContainer.innerHTML = '';
            
            try {
                const response = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${LATITUDE}&lon=${LONGITUDE}&exclude=minutely,hourly&units=metric&appid=${API_KEY}&lang=zh_cn`);
                
                if (!response.ok) {
                    throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status}`);
                }
                
                const data = await response.json();
                
                // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
                const now = new Date();
                document.getElementById('last-updated').textContent = now.toLocaleTimeString('zh-CN');
                
                // æ¸…ç©ºç°æœ‰çš„å¤©æ°”å¡ç‰‡
                weatherContainer.innerHTML = '';
                
                // ä¸ºæ¯ä¸€å¤©åˆ›å»ºå¤©æ°”å¡ç‰‡
                data.daily.slice(0, 7).forEach((day, index) => {
                    const date = new Date(day.dt * 1000);
                    const dayName = weekdays[date.getDay()];
                    const month = date.getMonth() + 1;
                    const dayOfMonth = date.getDate();
                    
                    // è·å–å¤©æ°”ç±»å‹
                    const weatherType = day.weather[0].main;
                    const weatherDesc = day.weather[0].description;
                    const weatherInfo = weatherTypeMap[weatherType] || weatherTypeMap['default'];
                    
                    // åˆ›å»ºå¤©æ°”å¡ç‰‡HTML
                    const cardHTML = `
                        <div class="weather-card">
                            <div class="card-header ${weatherInfo.class}">
                                <div class="date">${month}æœˆ${dayOfMonth}æ—¥</div>
                                <div class="day">${dayName}</div>
                                <div class="weather-desc">${weatherDesc}</div>
                                ${weatherInfo.elements}
                            </div>
                            <div class="card-body">
                                <div class="temperature">${Math.round(day.temp.max)}Â°C / ${Math.round(day.temp.min)}Â°C</div>
                                <div class="details">
                                    <div>
                                        <i class="humidity">ğŸ’§</i>
                                        <span>${day.humidity}%</span>
                                    </div>
                                    <div>
                                        <i class="wind">ğŸŒ¬ï¸</i>
                                        <span>${getWindDirection(day.wind_deg)} ${Math.round(day.wind_speed)}çº§</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // æ·»åŠ å¡ç‰‡åˆ°å®¹å™¨
                    weatherContainer.innerHTML += cardHTML;
                });
                
                // æ˜¾ç¤ºå¤©æ°”å®¹å™¨ï¼Œéšè—åŠ è½½ä¸­
                loadingElement.style.display = 'none';
                weatherContainer.style.display = 'flex';
                
            } catch (error) {
                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                loadingElement.style.display = 'none';
                errorContainer.innerHTML = `
                    <div class="error-message">
                        <p>è·å–å¤©æ°”æ•°æ®å¤±è´¥: ${error.message}</p>
                        <p>è¯·æ£€æŸ¥æ‚¨çš„APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆï¼Œæˆ–è€…ç¨åå†è¯•ã€‚</p>
                    </div>
                `;
                
                // æ˜¾ç¤ºå¤‡ç”¨é™æ€æ•°æ®
                showFallbackData();
            }
        }
        
        // æ ¹æ®è§’åº¦è·å–é£å‘
        function getWindDirection(degrees) {
            const directions = ['åŒ—', 'ä¸œåŒ—', 'ä¸œ', 'ä¸œå—', 'å—', 'è¥¿å—', 'è¥¿', 'è¥¿åŒ—'];
            const index = Math.round(degrees / 45) % 8;
            return directions[index] + 'é£';
        }
        
        // æ˜¾ç¤ºå¤‡ç”¨æ•°æ®ï¼ˆå½“APIè¯·æ±‚å¤±è´¥æ—¶ï¼‰
        function showFallbackData() {
            const weatherContainer = document.getElementById('weather-container');
            weatherContainer.innerHTML = `
                <!-- é™æ€å¤‡ç”¨æ•°æ® -->
                <div class="weather-card">
                    <div class="card-header sunny">
                        <div class="date">ä»Šå¤©</div>
                        <div class="day">${weekdays[currentDate.getDay()]}</div>
                        <div class="sun"></div>
                    </div>
                    <div class="card-body">
                        <div class="temperature">25Â°C / 18Â°C</div>
                        <div class="details">
                            <div>
                                <i class="humidity">ğŸ’§</i>
                                <span>45%</span>
                            </div>
                            <div>
                                <i class="wind">ğŸŒ¬ï¸</i>
                                <span>ä¸œé£3çº§</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å…¶ä»–é™æ€å¤‡ç”¨å¡ç‰‡ -->
                <!-- ä»¥ä¸‹æ˜¯åˆ›å»º6ä¸ªæ›´å¤šå¡ç‰‡çš„ç®€åŒ–ä»£ç  -->
            `;
            
            weatherContainer.style.display = 'flex';
        }
        
        // è®¾ç½®å®šæ—¶å™¨ï¼Œæ¯å°æ—¶åˆ·æ–°ä¸€æ¬¡å¤©æ°”æ•°æ®
        function setupAutoRefresh() {
            // åˆå§‹åŠ è½½
            fetchWeatherData();
            
            // è®¾ç½®æ¯å°æ—¶åˆ·æ–°
            setInterval(fetchWeatherData, 3600000); // 3600000æ¯«ç§’ = 1å°æ—¶
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', setupAutoRefresh);
    </script>
</body>
</html>
